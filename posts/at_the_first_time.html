<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>ブログを始めた - 線香とコーヒーと万年筆</title>
        <link rel="stylesheet" href="../css/default.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">線香とコーヒーと万年筆</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>ブログを始めた</h1>
            <article>
    <section class="header">
        Posted on 2020-07-04 (Sat)
        
    </section>
    <section>
        <p>いろいろ思うところがあり、ブログを運用することにしました。</p>
<h1 id="はじめに">はじめに</h1>
<p>もともと同名のブログをはてなブログで運営していたが（運営していたというほど記事をポストしていたわけではない）、 なんとなく愛着がわかないなー、と思っていた。</p>
<p>そんな中で、Github Pagesというものがあるのを知ったり（正確には前から知っていたが見えてなかった）、 Haskellでブログ書いてるー、みたいな記事をいくつか見つけたので、ちょっとやってみっか、と一念発起。</p>
<p>以下あたりを使ってみる。</p>
<ul>
<li>Org-mode</li>
<li>Hakyll</li>
<li>GitHub Pages</li>
</ul>
<h1 id="hakyllのセットアップ">Hakyllのセットアップ</h1>
<p>今回は、単にhaskell製の静的サイトジェネレータを使いたいのと、記事はorg-modeで書きたいので、Hakyllを使うことにした。 Hakyllは内部でpandocを使っており、markdownやorgをhtmlに変換してくれる。 （実はpandocをほとんど使ったことがないので、どのくらいちゃんと変換できるか、とかは知らない）</p>
<p>セットアップに当たっては以下を参考にした。（myuon氏のが特に参考になった。結構まねてる。）</p>
<ul>
<li><a href="https://myuon.github.io/posts/hakyll-blog/">HakyllでBlogを作る</a></li>
<li><a href="https://hackage.haskell.org/package/hakyll">hakyll: A static website compiler library</a></li>
<li><a href="https://jaspervdj.be/hakyll/tutorials.html">TUTORIALS ABOUT HAKYLL</a></li>
</ul>
<p>インストール〜プロジェクト作成は、雑に</p>
<pre class="shell"><code>$ stack install hakyll
$ stack exec hakyll-init my_site
</code></pre>
<p>とするだけ（stackを使う場合は、 <code>stack.yaml</code> も作っておく）。</p>
<p>プロジェクトを作成したばかりでも、 <code>stack build &amp;&amp; stack exec site build &amp;&amp; stack exec site watch</code> でサンプルサイトが立ち上がる。 出来上がった <code>site.hs</code> やhackageを見つつ、どんな処理してるのかを確認する。</p>
<p><code>stack exec site build</code> すると、デフォルトでは、 <code>_site</code> 配下にビルドされた静的コンテンツが、 <code>_cache</code> 配下に何らかのキャッシュが作成される。 これらは <code>.gitignore</code> で管理対象外にしておく（ついでに <code>.stack-work</code> も）。</p>
<h1 id="しくみ">しくみ</h1>
<p>上記の通り、生成された静的コンテンツは、デフォルトでは <code>_site</code> 配下に置かれるが、 masterブランチ直下をドキュメントルートとする場合には具合が悪い。</p>
<p>ところで、GitHub Pagesでは、masterブランチ直下をドキュメントルートとする代わりに、masterブランチの <code>docs</code> ディレクトリ配下をドキュメントルートとすることもできる。 ということは、ビルドした静的コンテンツが <code>_site/</code> ではなく <code>docs/</code> に配置されれば、それをそのままmasterブランチに <code>git push</code> すれば何も考えずに公開できる。 （それがいいことかどうかは置いといて・・・）</p>
<p>ではどうすればいいかというと、 <code>defaultConfiguration</code> を変更してあげればよい。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="ot">destChangeConfiguration ::</span> <span class="dt">Configuration</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>destChangeConfiguration <span class="ot">=</span> defaultConfiguration {destinationDirectory <span class="ot">=</span> <span class="st">&quot;docs&quot;</span> }</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>main <span class="ot">=</span> hakyllWith destChangeConfiguration <span class="op">$</span> <span class="kw">do</span> <span class="op">...</span></span></code></pre></div>
<p>これで、 <code>docs/</code> 配下に静的コンテンツが生成される。</p>
<h1 id="そのうち直したいなーなど">そのうち直したいなー、など</h1>
<p>まあ、ほんとにそのうち。</p>
<ul>
<li>スタイルが、デフォルトだと汚い。コードブロックとかきれいに表示したいし、フォントもイケてない。行もつまりすぎ。</li>
<li>タグ機能をつける。チュートリアルページから飛べる<a href="https://javran.github.io/posts/2014-03-01-add-tags-to-your-hakyll-blog.html">ここ</a>などが参考になるかも。</li>
<li>ページネーションつけたいなー。いろいろやってる人がいるので参考にする（だいたいslackで名前がでるつよつよの人）</li>
</ul>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
